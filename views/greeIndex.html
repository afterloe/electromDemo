<!DOCTYPE html>
<html lang="en" ng-app="GreeApp" ng-controller="GreeCtrl">
<head>
    <meta charset="UTF-8">
    <title>配送选型DEMO</title>
</head>
<body>
<!-- #include virtual = "../views/public/head.html" 引入控制窗口头 -->
<div ng-include="'../views/public/head.html'"></div>

<!-- 选型步骤导航 -->
<ul class="nav nav-tabs nav-justified">
    <li ng-class="{'active': !selectPlan}"><a ng-click="selectTab(1)">选择装备方案</a></li>
    <li ng-class="{'active': !selectCase}"><a ng-click="selectTab(2)">配置单</a></li>
    <!--<li ng-class="{'active': !selectBlower}"><a ng-click="selectTab(3)">风机部件</a></li>-->
    <!--<li ng-class="{'active': !selectElectricalBox}"><a ng-click="selectTab(4)">电器盒部件</a></li>-->
    <!--<li ng-class="{'active': !selectEvaporator}"><a ng-click="selectTab(5)">蒸发器部件</a></li>-->
    <li ng-class="{'active': !optionalList}"><a ng-click="selectTab(3)">总清单</a></li>
</ul>
<!-- 进度条 -->
<uib-progressbar class="progress-striped active" value="dynamic" type="success">{{dynamic}}% <i
        ng-show="showWarning">wait input</i></uib-progressbar>

<div class="container">
    <!-- TabPanel: 总清单 -->
    <div class="row" ng-hide="optionalList" ng-controller="optionalListCtr">
        <div class="row">
            <div class="col-md-10">
                <div class="thumbnail">
                    <img src="../sources/{{selectRandom}}" alt="请选择壳体相关数据!">

                    <div class="caption">
                        <h3>{{planName}}</h3>

                        <p>
                            <ng-bind-html ng-bind-html="TrustDangerousSnippet"></ng-bind-html>
                        </p>
                        <p>
                            <a href="#" class="btn btn-primary pull-right" role="button" ng-click="openPro()"
                               ng-disabled="selectPlan"><span
                                    class="glyphicon glyphicon-link"></span> 打开Pro/Engineer</a>&nbsp;
                            <a href="#" class="btn btn-default pull-right" role="button" ng-click="break(2)"
                               ng-disabled="selectPlan"><span
                                    class="glyphicon glyphicon-trash"></span> 重新选型</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- TabPanel: 壳体 -->
    <div class="row" ng-hide="selectCase" ng-controller="selectCaseCtr">
        <div class="col-md-8" ng-include src="'command.html'"></div>
        <div class="row">
            <div class="col-md-6 col-md-offset-5">
                <button type="button" class="btn btn-danger" ng-disabled="sourcePlan" ng-click="break(1)">
                    <span class="glyphicon glyphicon-chevron-left"></span> 返回
                </button>
                <button type="button" class="btn btn-success" ng-disabled="sourcePlan" ng-click="exportSelect()"><span
                        class="glyphicon glyphicon-export"></span> 确认选型
                </button>
            </div>
        </div>
    </div>

    <!-- TabPanel: 选择装备方案 -->
    <div class="row" ng-hide="selectPlan" ng-controller="selectPlanCtr">
        <div class="row">
            <div class="col-md-6">
                <div id="systemOrder" class="dropDomain" ondrop="drop(event,'source')" ondragover="allowDrop(event)"
                     electron-drop="source">
                    <h3>系统控件<span class="badge">{{dbCommandsNumber}}</span>
                        <small>选择需要的控件拖动到右边</small>
                    </h3>
                    <div ng-include src="'commandDrag.html'"></div>
                </div>
                <div class="col-md-6 col-md-offset-2">
                    <button type="button" class="btn btn-info" ng-click="selectFile()"><span
                            class="glyphicon glyphicon-link"></span> 载入库
                    </button>
                    <button type="button" class="btn btn-primary" ng-click="updateDB()"><span
                            class="glyphicon glyphicon-refresh"></span> 刷新库
                    </button>
                </div>
            </div>
            <div class="col-md-6">
                <div id="newSelectOrder" class="dropDomain" ondrop="drop(event,'tag')" ondragover="allowDrop(event)"
                     electron-drop="tag">
                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label class="col-sm-3 control-label">选择方案<span class="badge">{{planNumber}}</span></label>

                            <div class="col-sm-8">
                                <select class="form-control" ng-model="configurationPlan.selected"
                                        ng-options="o as o for o in configurationPlan.options"
                                        ng-change="loadPlain(configurationPlan.selected)"></select>
                            </div>
                        </div>
                    </form>
                    <ng-bind-html ng-bind-html="TrustDangerousSnippet(assemblyPlain)"></ng-bind-html>
                </div>
                <div class="col-md-6 col-md-offset-2">
                    <button type="button" class="btn btn-default" ng-click="resetNewSelectOrder()"
                            ng-disabled="!btn_create"><span
                            class="glyphicon glyphicon-repeat"></span> 重置
                    </button>
                    <button type="button" class="btn btn-danger" ng-click="saveConfigurationPlan()" ng-hide="!btn_save">
                        <span class="glyphicon glyphicon-floppy-saved"></span> 保存
                    </button>
                    <button type="button" class="btn btn-success" ng-hide="!btn_select"
                            ng-click="nextStep(configurationPlan.selected)"><span
                            class="glyphicon glyphicon-ok"></span> 应用
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<link rel="stylesheet" href="../sources/stylesheets/lib/tBootstrap.min.css">
<link rel="stylesheet" href="../sources/stylesheets/base.css">
<link rel="stylesheet" href="../sources/stylesheets/frameWindow.css">
<link rel="stylesheet" href="../sources/stylesheets/greeIndex.css">

<script type="text/javascript" src="../sources/javascripts/lib/angular.min.js"></script>
<script type="text/javascript" src="../sources/javascripts/lib/angular-animate.min.js"></script>
<script type="text/javascript" src="../sources/javascripts/lib/ui-bootstrap-tpls-1.3.3.min.js"></script>
<script type="text/javascript" src="../controller/contro_greeApp.js"></script>

<script type="text/ng-template" id="myModalContent.html">
    <div class="modal-header">
        <h3 class="modal-title">保存选型方案</h3>
    </div>
    <div class="modal-body">
        <div class="form-group">
            <label class="dropPrompt">方案名：</label>
            <input type="text" class="form-control" placeholder="请输入方案名" ng-model="planName"/>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" type="button" ng-click="ok()">保存</button>
        <button class="btn btn-warning" type="button" ng-click="cancel()">取消</button>
    </div>
</script>

<script type="text/ng-template" id="alertMessage.html">
    <div class="modal-header">
        <h3 class="modal-title">{{messageTitle}}</h3>
    </div>
    <div class="modal-body">
        {{messageContext}}
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" type="button" ng-click="ok()">确认</button>
        <button class="btn btn-warning" type="button" ng-click="cancel()">取消</button>
    </div>
</script>

<script type="text/ng-template" id="commandDrag.html">
    <ng-repeat ng-repeat="command in commands">
        <div draggable="true" ondragstart="drag(event)" id="{{command.id}}" class="electron-item">
            <div class="form-group">
                <label class="dropPrompt">{{command.name}}</label>
                <select class="form-control tagSelect" ng-model="command.options.selected"
                        ng-options="o as o for o in command.options.options" disabled="disabled"></select>
            </div>
        </div>
    </ng-repeat>
</script>

<script type="text/ng-template" id="command.html">
    <ng-repeat ng-repeat="command in commands">
        <div class="form-group" ng-class="{'has-error' : command.error}">
            <label class="dropPrompt">{{command.name}}</label>
            <select class="form-control" ng-model="command.options.selected"
                    ng-options="o as o for o in command.options.options" ng-change="checkOthers(command.options,command.name)"></select>
        </div>
    </ng-repeat>
</script>

</body>
</html>